소스 파일 하나에 여러 개의 톱레벨 클래스를 선언하는 것은 자바 컴파일러가 허용하지만, 이는 득이 없고 심각한 위험을 초래할 수 있다. 이런 방식은 한 클래스를 여러 가지로 정의할 수 있으며, 컴파일 순서에 따라 다른 클래스를 사용할 수 있기 때문이다.

예를 들어, `Main` 클래스가 두 개의 톱레벨 클래스 `Utensil`과 `Dessert`를 참조한다고 하자. 이 두 클래스가 `Utensil.java` 파일에 정의되어 있다면, `Main`을 실행하면 "pancake"를 출력할 것이다. 그런데 `Dessert.java` 파일에 같은 이름의 두 클래스를 정의하면, 컴파일 순서에 따라 출력이 달라질 수 있다.

- `javac Main.java Dessert.java` 명령으로 컴파일하면 컴파일 오류가 발생하고, 중복 정의가 있다고 알려준다.
- `javac Main.java` 또는 `javac Main.java Utensil.java` 명령으로 컴파일하면 "pancake"를 출력한다.
- `javac Dessert.java Main.java` 명령으로 컴파일하면 "potpie"를 출력한다.

이 문제는 간단히 톱레벨 클래스를 각기 다른 소스 파일로 분리하여 해결할 수 있다. 부차적인 클래스라면 정적 멤버 클래스로 만드는 것이 좋다. 이는 코드의 가독성을 높이고 접근 범위를 최소화할 수 있다.

다음은 정적 멤버 클래스로 바꾼 예시이다:

```java
public class Test {
    public static void main(String[] args) {
        System.out.println(Utensil.NAME + Dessert.NAME);
    }

    private static class Utensil {
        static final String NAME = "pan";
    }

    private static class Dessert {
        static final String NAME = "cake";
    }
}
```

이와 같이 정적 멤버 클래스를 사용하면 코드가 더 명확하고 관리하기 쉬워진다.

## 핵심정리
소스 파일 하나에는 반드시 톱레벨 클래스를 하나만 담자. 이 규칙만 따른다면 컴파일러가 한 클래스에 대한 정의를 여러 개 만들어 내는 일은 사라진다.
소스 파일을 어떤 순서로 컴파일하든 바이너리 파일이나 프로그램의 동작이 달라지는 일은 결코 일어나지 않을 것이다.